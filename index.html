<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë‚˜í´ë¦¬íƒ„ í˜¸í…” | ìš´ì˜ì§„ ì¡°ì‚¬ ì§€ë„</title>

<style>
:root{
  --bg:#0b0b0d;
  --card:#141417;
  --accent:#c9a24d;
  --sub:#8b1e1e;
  --text:#f5f5f7;
  --muted:#b7b9cc;
}

*{box-sizing:border-box}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:system-ui,-apple-system,Noto Sans KR,sans-serif;
}

header{
  padding:18px;
  text-align:center;
  border-bottom:1px solid #222;
}
header h1{margin:0;font-size:1.4rem}
header p{margin:6px 0 0;color:var(--muted);font-size:.85rem}

main{max-width:900px;margin:0 auto;padding:16px}

/* ---------- ë²„íŠ¼ ---------- */
button{
  background:var(--accent);
  color:#000;
  border:none;
  border-radius:8px;
  padding:6px 10px;
  font-size:.75rem;
  cursor:pointer;
}
button.sub{background:var(--sub);color:#fff}
button.ghost{background:#222;color:#ccc}

/* ---------- ì¸µ ---------- */
.floor{
  background:var(--card);
  border-radius:14px;
  margin-bottom:14px;
  overflow:hidden;
}
.floor-header{
  padding:14px 16px;
  background:linear-gradient(135deg,#1a0f0f,var(--sub));
  cursor:pointer;
}
.floor-header h2{margin:0;font-size:1rem}
.floor-header p{margin:4px 0 0;font-size:.8rem;color:var(--muted)}

.floor-controls{
  display:flex;
  gap:6px;
  padding:10px 16px;
}

.rooms{display:none;padding:10px 16px 16px}

/* ---------- ê³µê°„ ---------- */
.room{
  background:#1b1212;
  border-radius:10px;
  padding:10px;
  margin-top:10px;
}
.room h3{margin:0;font-size:.9rem}
.room p{margin:4px 0 0;font-size:.75rem;color:var(--muted)}

.tags{margin-top:6px}
.tag{
  display:inline-block;
  font-size:.65rem;
  padding:2px 6px;
  border-radius:6px;
  background:#333;
  margin-right:4px;
}

.room-controls{
  display:flex;
  gap:6px;
  margin-top:8px;
}

/* ---------- ì•„ì´í…œ ---------- */
.item{
  display:flex;
  align-items:center;
  gap:6px;
  font-size:.75rem;
  margin-top:6px;
}
.item.done{opacity:.4;text-decoration:line-through}

/* ---------- íŒì—… ---------- */
.popup{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:1000;
}
.popup-content{
  background:var(--card);
  width:90%;
  max-width:420px;
  border-radius:16px;
  padding:16px;
}
.popup-content h3{margin-top:0}
.popup-content input,
.popup-content textarea{
  width:100%;
  background:#0f0f12;
  color:var(--text);
  border:1px solid #333;
  border-radius:6px;
  padding:6px;
  margin-bottom:8px;
  font-size:.75rem;
}
.close{float:right;cursor:pointer;color:var(--muted)}

/* ---------- ëª¨ë°”ì¼ ---------- */
@media(max-width:600px){
  button{width:100%;padding:10px;font-size:.85rem}
  .floor-controls,.room-controls{flex-direction:column}
}
</style>
</head>

<body>

<header>
  <h1>NAPOLITAN HOTEL</h1>
  <p>ìš´ì˜ì§„ ì „ìš© ì¡°ì‚¬ ì§€ë„</p>
</header>

<main>
  <button onclick="addFloor()">â• ì¸µ ì¶”ê°€</button>
  <div id="floors"></div>
</main>

<!-- íŒì—… -->
<div class="popup" id="popup">
  <div class="popup-content">
    <span class="close" onclick="closePopup()">Ã—</span>
    <h3 id="popupTitle"></h3>
    <div id="popupBody"></div>
  </div>
</div>

<script>
let data = JSON.parse(localStorage.getItem('hotelData')) || [];

function save(){ localStorage.setItem('hotelData', JSON.stringify(data)); }

function render(){
  const wrap = document.getElementById('floors');
  wrap.innerHTML = '';
  data.forEach((f,fi)=>{
    const floor = document.createElement('div');
    floor.className='floor';

    floor.innerHTML = `
      <div class="floor-header" onclick="toggle(this)">
        <h2>${f.name}</h2>
        <p>${f.desc}</p>
      </div>
      <div class="floor-controls">
        <button onclick="editFloor(${fi})">ìˆ˜ì •</button>
        <button class="sub" onclick="deleteFloor(${fi})">ì‚­ì œ</button>
        <button onclick="addRoom(${fi})">ê³µê°„ ì¶”ê°€</button>
      </div>
      <div class="rooms"></div>
    `;

    const rooms = floor.querySelector('.rooms');
    f.rooms.forEach((r,ri)=>{
      const room = document.createElement('div');
      room.className='room';
      room.innerHTML = `
        <h3>${r.name}</h3>
        <p>${r.desc}</p>
        <div>
          ${r.items.map((it,ii)=>`
            <div class="item ${it.done?'done':''}">
              <input type="checkbox" ${it.done?'checked':''}
                onchange="toggleItem(${fi},${ri},${ii})">
              ${it.name}
            </div>`).join('')}
        </div>
        <div class="room-controls">
          <button onclick="addItem(${fi},${ri})">ì•„ì´í…œ ì¶”ê°€</button>
          <button onclick="editRoom(${fi},${ri})">ìˆ˜ì •</button>
          <button class="sub" onclick="deleteRoom(${fi},${ri})">ì‚­ì œ</button>
        </div>
      `;
      rooms.appendChild(room);
    });

    wrap.appendChild(floor);
  });
  save();
}

function toggle(el){
  const r = el.parentElement.querySelector('.rooms');
  r.style.display = r.style.display==='block'?'none':'block';
}

/* ---------- ì¸µ ---------- */
function addFloor(){
  data.push({name:'ìƒˆ ì¸µ',desc:'ì¸µ ì„¤ëª…',rooms:[]});
  render();
}
function editFloor(i){
  popup('ì¸µ ìˆ˜ì •',`
    <input id="fn" value="${data[i].name}">
    <textarea id="fd">${data[i].desc}</textarea>
    <button onclick="saveFloor(${i})">ì €ì¥</button>
  `);
}
function saveFloor(i){
  data[i].name=fn.value;
  data[i].desc=fd.value;
  closePopup();render();
}
function deleteFloor(i){
  if(confirm('ì‚­ì œ?')){data.splice(i,1);render();}
}

/* ---------- ê³µê°„ ---------- */
function addRoom(fi){
  data[fi].rooms.push({name:'ìƒˆ ê³µê°„',desc:'ì„¤ëª…',items:[]});
  render();
}
function editRoom(fi,ri){
  const r=data[fi].rooms[ri];
  popup('ê³µê°„ ìˆ˜ì •',`
    <input id="rn" value="${r.name}">
    <textarea id="rd">${r.desc}</textarea>
    <button onclick="saveRoom(${fi},${ri})">ì €ì¥</button>
  `);
}
function saveRoom(fi,ri){
  const r=data[fi].rooms[ri];
  r.name=rn.value;
  r.desc=rd.value;
  closePopup();render();
}
function deleteRoom(fi,ri){
  if(confirm('ì‚­ì œ?')){data[fi].rooms.splice(ri,1);render();}
}

/* ---------- ì•„ì´í…œ ---------- */
function addItem(fi,ri){
  popup('ì•„ì´í…œ ì¶”ê°€',`
    <input id="inm" placeholder="ì•„ì´í…œ ì´ë¦„">
    <textarea id="im">íšë“ ë°©ë²•</textarea>
    <button onclick="saveItem(${fi},${ri})">ì¶”ê°€</button>
  `);
}
function saveItem(fi,ri){
  data[fi].rooms[ri].items.push({
    name:inm.value,
    method:im.value,
    done:false
  });
  closePopup();render();
}
function toggleItem(fi,ri,ii){
  const it=data[fi].rooms[ri].items[ii];
  it.done=!it.done;
  render();
}

/* ---------- íŒì—… ---------- */
function popup(t,b){
  popupTitle.innerText=t;
  popupBody.innerHTML=b;
  popup.style.display='flex';
}
function closePopup(){ popup.style.display='none'; }

render();
</script>
</body>
</html>
  background:var(--bg);
  color:var(--text);
  font-family:system-ui, -apple-system, sans-serif;
  padding:14px;
}

button{
  background:var(--accent);
  color:#000;
  border:none;
  padding:8px 14px;
  border-radius:10px;
  font-size:.85rem;
  cursor:pointer;
}
button.sub{background:var(--sub); color:#fff}

header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:14px;
}
header h1{
  font-size:1.1rem;
  margin:0;
}

/* FLOOR */
.floor{
  background:var(--card);
  border-radius:16px;
  margin-bottom:14px;
  overflow:hidden;
}
.floor-header{
  padding:14px 16px;
  background:linear-gradient(135deg,#1a0f0f,var(--sub));
  cursor:pointer;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.floor-header h2{
  margin:0;
  font-size:.95rem;
}
.floor-header .state{
  font-size:.7rem;
  color:#ddd;
  opacity:.8;
}
.floor.locked .floor-header{
  background:linear-gradient(135deg,#1a1a1a,#333);
}
.floor.locked .state{
  color:#aaa;
}

.rooms{
  display:none;
  padding:12px;
}
.floor.open .rooms{display:block}

/* ROOM */
.room{
  background:#1b1212;
  border-radius:12px;
  padding:12px;
  margin-bottom:8px;
}
.room-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.room h3{
  margin:0;
  font-size:.85rem;
}
.room p{
  margin:4px 0 0;
  font-size:.75rem;
  color:var(--muted);
}

.room.locked{
  background:#181818;
  opacity:.6;
}
.room.locked h3::after{
  content:" ğŸ”’";
}

/* DRAG */
.floor-header,
.room{
  touch-action:none;
}
.dragging{
  opacity:.4;
}

/* MOBILE */
@media (min-width:768px){
  body{max-width:720px;margin:auto}
}
</style>
</head>

<body>

<header>
  <h1>ğŸ¨ ì¡°ì‚¬ ì‹œíŠ¸ (ìš´ì˜ì§„)</h1>
  <button onclick="addFloor()">+ ì¸µ ì¶”ê°€</button>
</header>

<div id="floors"></div>

<script>
const floorsEl = document.getElementById("floors");

/* ===== FLOOR ===== */
function addFloor(){
  const floor = document.createElement("div");
  floor.className = "floor";
  floor.draggable = true;

  floor.innerHTML = `
    <div class="floor-header">
      <h2 contenteditable="true">ìƒˆë¡œìš´ ì¸µ</h2>
      <span class="state">ì—´ë¦¼</span>
    </div>
    <div class="rooms"></div>
  `;

  floorsEl.appendChild(floor);
  setupFloor(floor);
}

function setupFloor(floor){
  const header = floor.querySelector(".floor-header");
  const rooms = floor.querySelector(".rooms");

  header.onclick = () => {
    if(floor.classList.contains("locked")) return;
    floor.classList.toggle("open");
  };

  // floor drag
  floor.addEventListener("dragstart",()=>floor.classList.add("dragging"));
  floor.addEventListener("dragend",()=>floor.classList.remove("dragging"));

  floorsEl.addEventListener("dragover",e=>{
    e.preventDefault();
    const after = getDragAfter(floorsEl,e.clientY,".floor");
    const dragging = document.querySelector(".floor.dragging");
    if(!dragging) return;
    after ? floorsEl.insertBefore(dragging,after) : floorsEl.appendChild(dragging);
  });

  // ê¸°ë³¸ ë°©
  addRoom(rooms);
}

/* ===== ROOM ===== */
function addRoom(rooms){
  const room = document.createElement("div");
  room.className = "room";
  room.draggable = true;

  room.innerHTML = `
    <div class="room-header">
      <h3 contenteditable="true">ë°© ì´ë¦„</h3>
      <button class="sub" onclick="toggleLock(event,this)">ì ê¸ˆ</button>
    </div>
    <p contenteditable="true">ê°„ë‹¨í•œ ì„¤ëª…</p>
  `;

  rooms.appendChild(room);

  room.addEventListener("dragstart",()=>room.classList.add("dragging"));
  room.addEventListener("dragend",()=>room.classList.remove("dragging"));

  rooms.addEventListener("dragover",e=>{
    e.preventDefault();
    const after = getDragAfter(rooms,e.clientY,".room");
    const dragging = document.querySelector(".room.dragging");
    if(!dragging) return;
    after ? rooms.insertBefore(dragging,after) : rooms.appendChild(dragging);
  });
}

/* ===== LOCK ===== */
function toggleLock(e,btn){
  e.stopPropagation();
  const room = btn.closest(".room");
  room.classList.toggle("locked");
  btn.textContent = room.classList.contains("locked") ? "í•´ì œ" : "ì ê¸ˆ";
}

/* ===== DRAG UTIL ===== */
function getDragAfter(container,y,selector){
  const els = [...container.querySelectorAll(`${selector}:not(.dragging)`)];
  return els.reduce((closest,el)=>{
    const box = el.getBoundingClientRect();
    const offset = y - box.top - box.height/2;
    if(offset < 0 && offset > closest.offset){
      return {offset,element:el};
    }else{
      return closest;
    }
  },{offset:Number.NEGATIVE_INFINITY}).element;
}

/* init */
addFloor();
</script>

</body>
</html>